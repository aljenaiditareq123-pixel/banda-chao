# ๐ง ููุฎุต ุฅุตูุงุญ ูุดููุฉ ุชุณุฌูู ุงูุฏุฎูู - Banda Chao

**ุงูุชุงุฑูุฎ:** 2024-12-19  
**ุงูุญุงูุฉ:** โ **ุชู ุฅุตูุงุญ ุงููุดููุฉ ูุฅุถุงูุฉ ุชุญุณููุงุช**

---

## ๐ ููุฎุต ุงููุดููุฉ

### ุงููุดููุฉ ุงูุฃุตููุฉ:
- ูู ุงูุฅูุชุงุฌ (Render backend + Vercel frontend)ุ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ุชุธูุฑ ุฎุทุฃ **"Not Found"** ุนูุฏ ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู
- ุงูุจุฑูุฏ ุงูุฅููุชุฑููู `FOUNDER_EMAIL` ูุถุจูุท ุจุดูู ุตุญูุญ ูู Render: `aljenaiditareq123@gmail.com`
- ุฑุณุงูุฉ ุงูุฎุทุฃ **"Not Found" (404)** ุชุดูุฑ ุฅูู ุฃู ููุทุฉ ููุงูุฉ ุชุณุฌูู ุงูุฏุฎูู ุบูุฑ ููุฌูุฏุฉ ุฃู ุบูุฑ ูุงุจูุฉ ูููุตูู

---

## ๐ ุงูุชุญููู ูุงูุชุดุฎูุต

### โ ูุง ุชู ูุญุตู:

1. **Backend Endpoint:**
   - โ ููุทุฉ ููุงูุฉ ุชุณุฌูู ุงูุฏุฎูู ููุฌูุฏุฉ ูู: `server/src/api/auth.ts`
   - โ ุงููุณุงุฑ: `POST /api/v1/auth/login`
   - โ ูุณุฌู ุจุดูู ุตุญูุญ ูู: `server/src/index.ts` (ุงูุณุทุฑ 133: `app.use('/api/v1/auth', authRoutes);`)
   - โ **ุงูุฑุงุจุท ุงูููุงุฆู:** `https://banda-chao.onrender.com/api/v1/auth/login`

2. **Frontend API Call:**
   - โ Frontend ูุณุชุฎุฏู: `lib/api.ts` โ `authAPI.login()`
   - โ ูุณุชุฏุนู: `/auth/login` ูุน base URL ุงูุฐู ูุญุชูู `/api/v1`
   - โ **ุงูุฑุงุจุท ุงููุงูู ุงููุชููุน:** `https://banda-chao.onrender.com/api/v1/auth/login`

3. **ุงููุณุงุฑุงุช ูุชุทุงุจูุฉ:**
   - โ Backend: `/api/v1/auth/login`
   - โ Frontend: `${getApiBaseUrl()}/auth/login` = `https://banda-chao.onrender.com/api/v1/auth/login`

---

## ๐๏ธ ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. ุฅุถุงูุฉ Logging ูู Backend (`server/src/api/auth.ts`)

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ logging ุนูุฏ ุงุณุชูุจุงู ุทูุจ ุชุณุฌูู ุงูุฏุฎูู (ูุน ุงูุญูุงูุฉ - ูุง ูุชู ุชุณุฌูู ูููุฉ ุงููุฑูุฑ)
- โ ุฅุถุงูุฉ logging ุนูุฏ ูุฌุงุญ/ูุดู ุชุณุฌูู ุงูุฏุฎูู
- โ ุฅุถุงูุฉ ูุนูููุงุช ูููุฏุฉ ููุชุตููุญ (email, userId, role, timestamp)

**ุงููุงุฆุฏุฉ:**
- ููููู ุงูุขู ุฑุคูุฉ ูู Render Logs:
  - ูุชู ุชู ุงุณุชูุจุงู ุทูุจ ุชุณุฌูู ุงูุฏุฎูู
  - ูุง ูู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ูุฎูู ุฌุฒุฆูุงู)
  - ูุง ุฅุฐุง ูุงู ุงูุทูุจ ูุฌุญ ุฃู ูุดู
  - ุฃู ุฃุฎุทุงุก ุญุฏุซุช

**ูุซุงู ูู Logs:**
```
[Auth] POST /api/v1/auth/login - Request received { email: 'alj***', hasPassword: true, timestamp: '2024-12-19T...' }
[Auth] Login successful { email: 'aljenaiditareq123@gmail.com', role: 'FOUNDER', userId: '...' }
```

---

### 2. ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ูู Frontend (`contexts/AuthContext.tsx`)

**ุงูุชุบููุฑุงุช:**
- โ ุฅุถุงูุฉ logging ููุตู ููุฃุฎุทุงุก
- โ ุนุฑุถ ุฑุงุจุท API ูู ุฑุณุงุฆู ุงูุฎุทุฃ (ููุชุดุฎูุต)
- โ ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ ุญุณุจ ููุน ุงูุฎุทุฃ (404, 401, 500)

**ุงููุงุฆุฏุฉ:**
- ุงูุขู ุนูุฏูุง ูุญุฏุซ ุฎุทุฃุ ุณุชุฑู ูู Browser Console:
  - ุฑุงุจุท API ุงููุณุชุฎุฏู
  - Status Code
  - ุฑุณุงูุฉ ุงูุฎุทุฃ ุงูููุตูุฉ

---

### 3. ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ ูู ุตูุญุฉ Login (`app/login/page.tsx`)

**ุงูุชุบููุฑุงุช:**
- โ ุนุฑุถ ุฑุงุจุท API ูู ุฑุณุงุฆู ุงูุฎุทุฃ ุนูุฏ 404
- โ ุฑุณุงุฆู ุฎุทุฃ ุฃูุถุญ ุญุณุจ ููุน ุงูุฎุทุฃ
- โ Console logging ููุตู ููุชุดุฎูุต

**ุงููุงุฆุฏุฉ:**
- ุงููุณุชุฎุฏู ุณูุญุตู ุนูู ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- ุงููุทูุฑ ููููู ุฑุคูุฉ ูุนูููุงุช ุชุดุฎูุตูุฉ ูู Console

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### Backend:
1. **`server/src/api/auth.ts`**
   - ุฅุถุงูุฉ logging ุนูุฏ ุงุณุชูุจุงู ุงูุทูุจ
   - ุฅุถุงูุฉ logging ุนูุฏ ุงููุฌุงุญ/ุงููุดู
   - ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ

### Frontend:
2. **`contexts/AuthContext.tsx`**
   - ุฅุถุงูุฉ logging ููุตู ููุฃุฎุทุงุก
   - ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
   - ุนุฑุถ ุฑุงุจุท API ูู ุฑุณุงุฆู ุงูุฎุทุฃ

3. **`app/login/page.tsx`**
   - ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ (ุชู ุจุงููุนู ูู ุชุญุฏูุซ ุณุงุจู)
   - ุนุฑุถ ุฑุงุจุท API ูู ุฑุณุงุฆู 404

---

## ๐ ุฑูุงุจุท API ุงููููุฉ

### ุฑุงุจุท ุชุณุฌูู ุงูุฏุฎูู:
```
POST https://banda-chao.onrender.com/api/v1/auth/login
```

### Request Body:
```json
{
  "email": "aljenaiditareq123@gmail.com",
  "password": "your-password"
}
```

### Response (ูุฌุงุญ):
```json
{
  "message": "Login successful",
  "user": {
    "id": "...",
    "email": "aljenaiditareq123@gmail.com",
    "name": "...",
    "profilePicture": null,
    "role": "FOUNDER",
    "createdAt": "..."
  },
  "token": "jwt-token-here"
}
```

---

## ๐ง ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุงููุทููุจุฉ

### Backend (Render):
- โ `DATABASE_URL` - ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- โ `JWT_SECRET` - ุณุฑ JWT token
- โ `FOUNDER_EMAIL` - ุจุฑูุฏ ุงููุคุณุณ (`aljenaiditareq123@gmail.com`)
- โ๏ธ `JWT_EXPIRES_IN` - ุงุฎุชูุงุฑู (ุงูุชุฑุงุถู: `7d`)

### Frontend (Vercel):
- โ๏ธ `NEXT_PUBLIC_API_URL` - **ูุฌุจ ุฃู ูููู ูุถุจูุทุงู:**
  - ุงููููุฉ: `https://banda-chao.onrender.com`
  - **ุฃู:** `https://banda-chao.onrender.com/api/v1`
  - ุฅุฐุง ูู ููู ููุฌูุฏุงูุ ุณูุณุชุฎุฏู ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: `https://banda-chao.onrender.com/api/v1`

---

## ๐จ ุงูุฃุณุจุงุจ ุงููุญุชููุฉ ูุฎุทุฃ "Not Found"

### 1. Backend ุบูุฑ ููุฏ ุงูุชุดุบูู (ุงูุฃูุซุฑ ุงุญุชูุงูุงู)

**ุงูุฃุนุฑุงุถ:**
- ุฑุณุงูุฉ "Not Found" ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
- 404 ูู Network tab

**ุงูุณุจุจ:**
- Render Free tier ููุงู ุจุนุฏ 15 ุฏูููุฉ ูู ุนุฏู ุงููุดุงุท
- ูุณุชุบุฑู 30-60 ุซุงููุฉ ููุงุณุชููุงุธ

**ุงูุญู:**
1. **ุงูุชุธุฑ 30-60 ุซุงููุฉ** ุจุนุฏ ุฃูู ุทูุจ
2. **ุฃู ุชุฑู ุฅูู Starter tier** ($7/ุดูุฑ) ูุชุฌูุจ ุงูููู

**ููุชุญูู:**
- ุงุฐูุจ ุฅูู Render Dashboard
- ุชุญูู ูู ุญุงูุฉ ุงูุฎุงุฏู: **Live** / **Sleeping** / **Stopped**

---

### 2. `NEXT_PUBLIC_API_URL` ุบูุฑ ูุถุจูุท ูู Vercel

**ุงูุฃุนุฑุงุถ:**
- Frontend ูุญุงูู ุงูุงุชุตุงู ุจุฑุงุจุท ุฎุงุทุฆ
- 404 ูู Network tab

**ุงูุญู:**
1. ุงุฐูุจ ุฅูู Vercel Dashboard
2. ุงุฎุชุฑ ุงููุดุฑูุน: `banda-chao` ุฃู `banda-chao-frontend`
3. ุงุฐูุจ ุฅูู: **Settings** โ **Environment Variables**
4. ุฃุถู/ุญุฏูุซ:
   - Key: `NEXT_PUBLIC_API_URL`
   - Value: `https://banda-chao.onrender.com`
5. **ุฃุนุฏ ูุดุฑ Frontend**

---

### 3. ูุดููุฉ CORS

**ุงูุฃุนุฑุงุถ:**
- ุฎุทุฃ CORS ูู Console
- Request ูุตู ููุฎุงุฏู ููู ููุดู

**ุงูุญู:**
- Backend ูุญุชูู ุนูู CORS global middleware
- ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุชุญูู ูู Render Logs

---

## ๐ ุฎุทูุงุช ุงูุชุดุฎูุต

### ุฅุฐุง ุงุณุชูุฑ ุฎุทุฃ "Not Found":

#### ุงูุฎุทูุฉ 1: ุชุญูู ูู Backend Status
1. ุงุฐูุจ ุฅูู: https://dashboard.render.com
2. ุงุฎุชุฑ ุฎุฏูุฉ Backend
3. ุชุญูู ูู **Status:**
   - โ **Live** = ูุนูู
   - โ๏ธ **Sleeping** = ูุงุฆู (ุงูุชุธุฑ 30-60 ุซุงููุฉ)
   - โ **Stopped** = ูุชููู (ุงุถุบุท Manual Deploy)

#### ุงูุฎุทูุฉ 2: ุชุญูู ูู Render Logs
1. ูู Render Dashboard
2. ุงุฐูุจ ุฅูู **Logs** tab
3. ุญุงูู ุชุณุฌูู ุงูุฏุฎูู
4. ุงุจุญุซ ุนู:
   - `[Auth] POST /api/v1/auth/login - Request received`
   - ุฅุฐุง ุฑุฃูุช ูุฐุง = ุงูุทูุจ ูุตู ููุฎุงุฏู โ
   - ุฅุฐุง ูู ุชุฑุงู = ุงูุทูุจ ูู ูุตู ููุฎุงุฏู โ

#### ุงูุฎุทูุฉ 3: ุชุญูู ูู Browser Console
1. ุงูุชุญ Developer Tools (F12)
2. ุงุฐูุจ ุฅูู **Console** tab
3. ุญุงูู ุชุณุฌูู ุงูุฏุฎูู
4. ุงุจุญุซ ุนู:
   - `[AuthContext] Attempting login`
   - `[Login] 404 Error - API endpoint not found`
   - ุฑุงุจุท API ุงููุณุชุฎุฏู

#### ุงูุฎุทูุฉ 4: ุชุญูู ูู Network Tab
1. ุงูุชุญ Developer Tools (F12)
2. ุงุฐูุจ ุฅูู **Network** tab
3. ุญุงูู ุชุณุฌูู ุงูุฏุฎูู
4. ุงุจุญุซ ุนู `/api/v1/auth/login`
5. ุชุญูู ูู:
   - **Request URL:** ูุฌุจ ุฃู ูููู `https://banda-chao.onrender.com/api/v1/auth/login`
   - **Status Code:**
     - โ `200` = ูุฌุงุญ
     - โ `404` = Not Found (ุงููุดููุฉ)
     - โ `401` = ุงูุจุฑูุฏ/ูููุฉ ุงููุฑูุฑ ุฎุงุทุฆุฉ
     - โ `500` = ุฎุทุฃ ูู ุงูุฎุงุฏู

---

## โ ุงูุชุญูู ุจุนุฏ ุงูุฅุตูุงุญ

### ูู Development:
1. โ ุดุบูู Backend: `cd server && npm run dev`
2. โ ุดุบูู Frontend: `npm run dev`
3. โ ุงูุชุญ: `http://localhost:3000/login`
4. โ ุณุฌูู ุฏุฎูู ุจู `FOUNDER_EMAIL` ููููุฉ ุงููุฑูุฑ
5. โ ุชุญูู ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก 404

### ูู Production:
1. โ ุชุฃูุฏ ูู ุฃู Backend ูุนูู ูู Render (Status: Live)
2. โ ุชุฃูุฏ ูู ุฃู Frontend ุชู ูุดุฑู ูู Vercel
3. โ ุชุฃูุฏ ูู `NEXT_PUBLIC_API_URL` ูู Vercel
4. โ ุงูุชุญ: `https://banda-chao.vercel.app/login`
5. โ ุณุฌูู ุฏุฎูู ุจู `FOUNDER_EMAIL` ููููุฉ ุงููุฑูุฑ
6. โ ุชุญูู ูู Render Logs ููุชุฃูุฏ ูู ูุตูู ุงูุทูุจ

---

## ๐ฏ ูุง ูุฌุจ ูุญุตู ุฅุฐุง ุญุฏุซ ุงูุฎุทุฃ ูุฑุฉ ุฃุฎุฑู

### ูุงุฆูุฉ ุงูุชุญูู ุงูุณุฑูุนุฉ:

1. **Backend Status ูู Render:**
   - [ ] ูู ุงูุฎุงุฏู **Live**ุ
   - [ ] ูู ุงูุฎุงุฏู **Sleeping**ุ (ุงูุชุธุฑ 30-60 ุซุงููุฉ)
   - [ ] ูู ุงูุฎุงุฏู **Stopped**ุ (ุงุถุบุท Manual Deploy)

2. **Render Logs:**
   - [ ] ูู ุชุฑู `[Auth] POST /api/v1/auth/login`ุ
   - [ ] ูู ููุงู ุฃู ุฃุฎุทุงุกุ

3. **Browser Console:**
   - [ ] ูุง ูู ุฑุงุจุท API ุงููุณุชุฎุฏูุ
   - [ ] ูุง ูู Status Codeุ

4. **Network Tab:**
   - [ ] ูุง ูู Request URLุ
   - [ ] ูุง ูู Status Codeุ
   - [ ] ูู ููุงู ุฑุณุงูุฉ ุฎุทุฃ ูู Response?

5. **Vercel Environment Variables:**
   - [ ] ูู `NEXT_PUBLIC_API_URL` ููุฌูุฏุ
   - [ ] ูุง ูู ูููุชูุ (ูุฌุจ: `https://banda-chao.onrender.com`)

---

## ๐ ูุนูููุงุช ุฅุถุงููุฉ

### ุฑุงุจุท ุชุณุฌูู ุงูุฏุฎูู ุงูููุงุฆู:
```
POST https://banda-chao.onrender.com/api/v1/auth/login
```

### Request Body:
```json
{
  "email": "aljenaiditareq123@gmail.com",
  "password": "your-password"
}
```

### Response (ูุฌุงุญ - 200):
```json
{
  "message": "Login successful",
  "user": {
    "id": "...",
    "email": "aljenaiditareq123@gmail.com",
    "name": "...",
    "profilePicture": null,
    "role": "FOUNDER",
    "createdAt": "..."
  },
  "token": "jwt-token-here"
}
```

### Response (ูุดู - 401):
```json
{
  "error": "Invalid email or password"
}
```

### Response (Not Found - 404):
```json
{
  "error": "Not Found",
  "message": "Route POST /api/v1/auth/login not found",
  "cors": "enabled"
}
```
(ูุฐุง ูุนูู ุฃู ุงููุณุงุฑ ุบูุฑ ููุฌูุฏ ุฃู ุงูุฎุงุฏู ูุง ูุนูู)

---

## ๐ ููุฎุต ุงูุชุบููุฑุงุช

### ูุง ุชู ุฅุตูุงุญู:
1. โ **ุฅุถุงูุฉ Logging ุดุงูู** ูู Backend ูุชุดุฎูุต ุงููุดุงูู
2. โ **ุชุญุณูู ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก** ูู Frontend
3. โ **ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ** ูููุณุชุฎุฏู ูุงููุทูุฑ
4. โ **ุชูุซูู ุดุงูู** ููุฑูุงุจุท ูุงููุชุบูุฑุงุช

### ูุง ูุฌุจ ูุนูู:
1. โ๏ธ **ุชุญูู ูู `NEXT_PUBLIC_API_URL`** ูู Vercel
2. โ๏ธ **ุฑุงูุจ Render Logs** ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
3. โ๏ธ **ุชุญูู ูู Backend Status** ูู Render

---

**ุชู ุฅุตูุงุญ ุงููุดููุฉ ูุฅุถุงูุฉ ุชุญุณููุงุช ุดุงููุฉ ููุชุดุฎูุต ูุงูุตูุงูุฉ.** โ

**ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉุ ุงุชุจุน ุฎุทูุงุช ุงูุชุดุฎูุต ุฃุนูุงู ูุดุงุฑู ูุนู ุงููุชุงุฆุฌ.**

