# ๐ ุชูุฑูุฑ ุงููุญุต ุงูุดุงูู

**ุงูุชุงุฑูุฎ:** 6 ููููุจุฑ 2025

---

## ๐ **1. ูุญุต `lib/api.ts`:**

### **ุงูุณุทุฑ ุงูุฐู ูุญุฏุฏ API_URL:**

```typescript
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api/v1';
```

**ุงููููุน:** ุงูุณุทุฑ 3

---

### **ุงููุดููุฉ ุงูููุชุดูุฉ:**

โ **Fallback URL ูุญุชูู ุนูู `/api/v1` ูู ุงูููุงูุฉ!**

**ุงูุณุจุจ:**
- ุฅุฐุง ูู ูุชู ุชุญููู `NEXT_PUBLIC_API_URL` ูู Build Timeุ ุณูุณุชุฎุฏู `http://localhost:3001/api/v1`
- ููู Backend URL ุงูุตุญูุญ ูุฌุจ ุฃู ูููู: `https://banda-chao-backend.onrender.com` (ุจุฏูู `/api/v1`)
- ูุฃู axios ูุถูู `/api/v1` ุชููุงุฆูุงู ุนูุฏ ุงุณุชุฏุนุงุก `api.get('/videos')`

**ูุซุงู:**
- โ ุตุญูุญ: `baseURL = 'https://banda-chao-backend.onrender.com'` โ `api.get('/videos')` โ `https://banda-chao-backend.onrender.com/api/v1/videos`
- โ ุฎุทุฃ: `baseURL = 'https://banda-chao-backend.onrender.com/api/v1'` โ `api.get('/videos')` โ `https://banda-chao-backend.onrender.com/api/v1/videos` (ุตุญูุญ ููู ุบูุฑ ุถุฑูุฑู)
- โ ุฎุทุฃ: `baseURL = 'http://localhost:3001/api/v1'` โ `api.get('/videos')` โ `http://localhost:3001/api/v1/videos` (ุฎุทุฃ ูู Production!)

---

## ๐ **2. ูุญุต `app/page-client.tsx`:**

### **ููู ูุชู ุงุณุชุฏุนุงุก API:**

```typescript
// ุงูุณุทุฑ 56: ุงุณุชุฏุนุงุก Videos API
const shortVideosRes = await videosAPI.getVideos('short', 1, 5);
const shortVideosData = shortVideosRes.data.data || [];

// ุงูุณุทุฑ 90: ุงุณุชุฏุนุงุก Products API
const productsRes = await productsAPI.getProducts();
const productsData = Array.isArray(productsRes.data) ? productsRes.data : [];
```

**ุงูุชุญููู:**
- โ ูุณุชุฎุฏู `videosAPI` ู `productsAPI` ุจุดูู ุตุญูุญ
- โ ูุนุงูุฌุฉ Response ุตุญูุญุฉ
- โ Error handling ููุฌูุฏ

---

## ๐ **3. ูุญุต `app/videos/short/page-client.tsx`:**

### **ููู ูุชู ุงุณุชุฏุนุงุก API:**

```typescript
// ุงูุณุทุฑ 31: ุงุณุชุฏุนุงุก Videos API
const response = await videosAPI.getVideos('short', currentPage, ITEMS_PER_PAGE);
const data = response.data;
const formattedVideos = (data.data || []).map((video: any) => ({...}));
```

**ุงูุชุญููู:**
- โ ูุณุชุฎุฏู `videosAPI` ุจุดูู ุตุญูุญ
- โ ูุนุงูุฌุฉ Response ุตุญูุญุฉ
- โ Error handling ููุฌูุฏ

---

## โ **ุงูุชุญูู ูู ุงุณุชุฎุฏุงู `NEXT_PUBLIC_API_URL`:**

### **ุงููุชูุฌุฉ:**

โ **ูุชู ุงุณุชุฎุฏุงู `NEXT_PUBLIC_API_URL` ุจุดูู ุตุญูุญ ูู:**
- `lib/api.ts` - ุงูุณุทุฑ 3
- `lib/socket.ts` - ุงูุณุทุฑ 3 (ูู Socket URL)

---

## โ **ุงููุดุงูู ุงูููุชุดูุฉ:**

### **ุงููุดููุฉ 1: Fallback URL ุฎุงุทุฆ**

**ุงููููุน:** `lib/api.ts` - ุงูุณุทุฑ 3

**ุงูููุฏ ุงูุญุงูู:**
```typescript
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api/v1';
```

**ุงููุดููุฉ:**
- Fallback URL ูุญุชูู ุนูู `/api/v1` ูู ุงูููุงูุฉ
- ูุฐุง ูุฏ ูุณุจุจ ูุดุงูู ุฅุฐุง ูู ูุชู ุชุญููู Environment Variable

**ุงูุญู:**
```typescript
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL 
  ? `${process.env.NEXT_PUBLIC_API_URL}/api/v1`
  : 'http://localhost:3001/api/v1';
```

ุฃู ุฃูุถู:
```typescript
const API_BASE_URL = (process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001') + '/api/v1';
```

---

### **ุงููุดููุฉ 2: Environment Variable ูุฏ ูุง ุชุญุชูู ุนูู `/api/v1`**

**ุงูุชุญููู:**
- ูู Vercelุ `NEXT_PUBLIC_API_URL` = `https://banda-chao-backend.onrender.com` (ุจุฏูู `/api/v1`)
- ููู ุงูููุฏ ูุณุชุฎุฏู `baseURL` ูุจุงุดุฑุฉ
- axios ูุถูู ุงููุณุงุฑ ุชููุงุฆูุงูุ ููู ูุฌุจ ุฃู ูููู `baseURL` ูุญุชูู ุนูู `/api/v1`

**ุงูุญู:**
- ุฅูุง ุฅุถุงูุฉ `/api/v1` ูู Environment Variable
- ุฃู ุฅุถุงูุฉ `/api/v1` ูู ุงูููุฏ

---

## โ **ุงูุชุญูู ูู ุงุณุชุฎุฏุงู Supabase:**

### **ุงููุชูุฌุฉ:**

โ **ูุง ููุฌุฏ ุงุณุชุฎุฏุงู ูู Supabase ูู ุตูุญุงุช ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ**

**ูููุงุช ุชุญุชูู ุนูู Supabase (ูุง ุชุคุซุฑ ุนูู ุงูุจูุงูุงุช ุงูุฑุฆูุณูุฉ):**
- `app/upload/page.tsx` - ุตูุญุฉ upload
- `app/auth/callback/route.ts` - callback route

---

## ๐ง **ุงูุฅุตูุงุญุงุช ุงููุทููุจุฉ:**

### **ุงูุฅุตูุงุญ 1: ุชุญุฏูุซ `lib/api.ts`**

**ุงูููุฏ ุงูุญุงูู:**
```typescript
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001/api/v1';
```

**ุงูููุฏ ุงููุญุฏุซ:**
```typescript
// Ensure API_BASE_URL always includes /api/v1
const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL 
  ? `${process.env.NEXT_PUBLIC_API_URL}/api/v1`
  : 'http://localhost:3001/api/v1';
```

---

## ๐ **ููุฎุต ุงููุดุงูู:**

1. โ **Fallback URL ูุฏ ูุณุจุจ ูุดุงูู** - ูุญุชุงุฌ ุชุญุฏูุซ
2. โ **ุงุณุชุฎุฏุงู API ุตุญูุญ** - ูุง ูุญุชุงุฌ ุชุนุฏูู
3. โ **ูุง ููุฌุฏ ุงุณุชุฎุฏุงู ูู Supabase** - ูุง ูุดููุฉ
4. โ **Environment Variable ูุฏ ูุง ุชุญุชูู ุนูู `/api/v1`** - ูุญุชุงุฌ ุงูุชุญูู

---

**๐ ุชุงุฑูุฎ:** ุงูููู  
**โ๏ธ ุงูุญุงูุฉ:** ๐ง **ูุญุชุงุฌ ุฅุตูุงุญ `lib/api.ts`**

