# ๐ข ุงุณุชุฑุงุชูุฌูุฉ ุงูุดุญู Hub Model (ุงูุตูู -> ุงูุฅูุงุฑุงุช -> ุงูุนุงูู)

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทุจูู ุงุณุชุฑุงุชูุฌูุฉ **Hub Model** ูุญุณุงุจ ุชูููุฉ ุงูุดุญู ูู ููุตุฉ Banda Chao. ูุฐู ุงูุงุณุชุฑุงุชูุฌูุฉ ุชุญุงูู ูููุฐุฌ ุฅุนุงุฏุฉ ุงูุชุตุฏูุฑ (Re-export) ุงูุฐู ูุณุชููุฏ ูู:
- **ุตูุฑ ุถุฑุงุฆุจ** ุนูุฏ ุฎุฑูุฌ ุงูุจุถุงุนุฉ ูู ุงูุตูู
- **ุงุชูุงููุงุช ุงูุชุฌุงุฑุฉ ุงูุญุฑุฉ** ุนูุฏ ุฎุฑูุฌูุง ูู ุงูุฅูุงุฑุงุช ุฅูู ุงูุนุงูู

## ๐ ูุฑุงุญู ุงูุดุญู

### ุงููุฑุญูุฉ ุงูุฃููู: ุงูุตูู โ ูุฎุงุฒู ุฑุฃุณ ุงูุฎููุฉ (ุงูุฅูุงุฑุงุช)
- **ุงูุณุนุฑ**: 15 ุฏุฑูู ุฅูุงุฑุงุชู ููู ููููุฌุฑุงู
- **ุงููุตู**: ุชูููุฉ ููู ุงูุจุถุงุนุฉ ูู ุงููุตูุน ูู ุงูุตูู ุฅูู ูุฎุงุฒู ุฑุฃุณ ุงูุฎููุฉ

### ุงููุฑุญูุฉ ุงูุซุงููุฉ: ุฑุณูู ุงูููุงููุฉ ูุงูุชุฌููุฒ
- **ุงูุณุนุฑ**: 25 ุฏุฑูู ุฅูุงุฑุงุชู (ูุจูุบ ุซุงุจุช ููู ุทูุจ)
- **ุงููุตู**: ุฑุณูู ุงูุชุบููู ูุงูุชุฌููุฒ ูู ูุฎุงุฒู ุฑุฃุณ ุงูุฎููุฉ

### ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ุฑุฃุณ ุงูุฎููุฉ โ ุงูุนููู (ุญุณุจ ุงูุฏููุฉ)
- **ุฃูุฑููุง (US)**: 40 ุฏุฑูู ูููููู
- **ุฃูุฑูุจุง (EU)**: 35 ุฏุฑูู ูููููู
- **ุฏูู ุงูุฎููุฌ (GCC)**: 20 ุฏุฑูู ูููููู
- **ุจุงูู ุฏูู ุงูุนุงูู**: 50 ุฏุฑูู ูููููู

## ๐ ุงููููุงุช ุงููุถุงูุฉ/ุงููุนุฏูุฉ

### 1. `server/src/config/shippingRates.ts` (ุฌุฏูุฏ)
ูุญุชูู ุนูู:
- ุฅุนุฏุงุฏุงุช ุงูุฃุณุนุงุฑ (`SHIPPING_STRATEGY`)
- ุฏุงูุฉ `calculateHubShipping()` - ูุญุณุงุจ ุงูุดุญู ูููุชุฌ ูุงุญุฏ
- ุฏุงูุฉ `calculateHubShippingForItems()` - ูุญุณุงุจ ุงูุดุญู ูุนุฏุฉ ููุชุฌุงุช
- ุชุญุฏูุฏ ููุทูุฉ ุงูุดุญู ุชููุงุฆูุงู ุจูุงุกู ุนูู ุฑูุฒ ุงูุฏููุฉ

### 2. `server/src/api/orders.ts` (ูุญุฏุซ)
ุชู ุชุญุฏูุซ ุฏุงูุฉ ุฅูุดุงุก ุงูุทูุจ (`POST /orders`) ูุชุณุชุฎุฏู ุญุณุงุจ ุงูุดุญู ุงูุฌุฏูุฏ:
- ุญุณุงุจ ุชูููุฉ ุงูููุชุฌุงุช (ุจุฏูู ุงูุดุญู)
- ุญุณุงุจ ุชูููุฉ ุงูุดุญู ุจุงุณุชุฎุฏุงู Hub Model
- ุฅุถุงูุฉ ุชูููุฉ ุงูุดุญู ุฅูู ุงููุจูุบ ุงูุฅุฌูุงูู
- ุฅุฑุฌุงุน ุชูุงุตูู ุญุณุงุจ ุงูุดุญู ูู ุงูุงุณุชุฌุงุจุฉ

## ๐ป ููููุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุงูููุฏ:

```typescript
import { calculateHubShipping, calculateHubShippingForItems } from '../config/shippingRates';

// ูุซุงู 1: ุญุณุงุจ ุงูุดุญู ูููุชุฌ ูุงุญุฏ
const shipping = calculateHubShipping('US', 2.5); // ุฃูุฑููุงุ ูุฒู 2.5 ูุฌู
console.log(shipping.total); // ุงููุจูุบ ุงูุฅุฌูุงูู

// ูุซุงู 2: ุญุณุงุจ ุงูุดุญู ูุนุฏุฉ ููุชุฌุงุช
const shipping = calculateHubShippingForItems('DE', [
  { weightInKg: 1.5, quantity: 2 }, // ููุชุฌ 1: 1.5 ูุฌู ร 2
  { weightInKg: 0.8, quantity: 1 }, // ููุชุฌ 2: 0.8 ูุฌู ร 1
]);
console.log(shipping.total); // ุงููุจูุบ ุงูุฅุฌูุงูู
```

### ูู API Request:

ุนูุฏ ุฅูุดุงุก ุทูุจ ุฌุฏูุฏ (`POST /api/v1/orders`):

```json
{
  "items": [
    {
      "productId": "product-id-123",
      "quantity": 2,
      "price": 100,
      "weightInKg": 1.5  // ุงุฎุชูุงุฑู - ุฅุฐุง ูู ูุญุฏุฏุ ูุณุชุฎุฏู 1 ูุฌู ุงูุชุฑุงุถู
    }
  ],
  "shipping": {
    "name": "John Doe",
    "address": "123 Main St",
    "city": "New York",
    "country": "US",  // โ๏ธ ููู: ุฑูุฒ ุงูุฏููุฉ (US, DE, SA, etc.)
    "zip": "10001"
  }
}
```

### Response:

```json
{
  "success": true,
  "orderId": "order-id-123",
  "order": {
    "id": "order-id-123",
    "status": "PENDING",
    "totalAmount": 350,  // ุณุนุฑ ุงูููุชุฌุงุช + ุงูุดุญู
    "productsTotal": 200,  // ุณุนุฑ ุงูููุชุฌุงุช ููุท
    "shippingCost": 150,  // ุชูููุฉ ุงูุดุญู
    "shippingDetails": {
      "region": "US",
      "chinaToUae": 37.5,  // ุงูุตูู -> ุงูุฅูุงุฑุงุช
      "handling": 25,      // ุฑุณูู ุงูููุงููุฉ
      "uaeToCustomer": 87.5,  // ุงูุฅูุงุฑุงุช -> ุงูุนููู
      "total": 150
    },
    "items": [...]
  }
}
```

## ๐ ุฑููุฒ ุงูุฏูู ุงููุฏุนููุฉ

### ุฏูู ุงูุฎููุฌ (GCC):
- `AE` - ุงูุฅูุงุฑุงุช ุงูุนุฑุจูุฉ ุงููุชุญุฏุฉ
- `SA` - ุงูุณุนูุฏูุฉ
- `KW` - ุงููููุช
- `QA` - ูุทุฑ
- `BH` - ุงูุจุญุฑูู
- `OM` - ุนูุงู

### ุฏูู ุฃูุฑูุจุง (EU):
- ุฌููุน ุฏูู ุงูุงุชุญุงุฏ ุงูุฃูุฑูุจู (AT, BE, BG, HR, CY, CZ, DK, EE, FI, FR, DE, GR, HU, IE, IT, LV, LT, LU, MT, NL, PL, PT, RO, SK, SI, ES, SE, GB, UK)

### ุฃูุฑููุง:
- `US` - ุงูููุงูุงุช ุงููุชุญุฏุฉ

### ุจุงูู ุงูุฏูู:
- ุฃู ุฑูุฒ ุฏููุฉ ุขุฎุฑ ูุณุชุฎุฏู ุงูุณุนุฑ ุงูุงูุชุฑุงุถู (50 ุฏุฑูู ูููููู)

## โ๏ธ ุชุนุฏูู ุงูุฃุณุนุงุฑ

ูุชุนุฏูู ุงูุฃุณุนุงุฑุ ุงูุชุญ `server/src/config/shippingRates.ts` ูุนุฏูู ุงูููู ูู `SHIPPING_STRATEGY`:

```typescript
export const SHIPPING_STRATEGY = {
  CHINA_TO_UAE_RATE_PER_KG: 15,  // ุบููุฑ ูุฐุง ุงูุณุนุฑ
  UAE_HANDLING_FEE: 25,           // ุบููุฑ ูุฐุง ุงูุณุนุฑ
  UAE_TO_WORLD_RATES: {
    US: 40,      // ุบููุฑ ูุฐุง ุงูุณุนุฑ
    EU: 35,      // ุบููุฑ ูุฐุง ุงูุณุนุฑ
    GCC: 20,     // ุบููุฑ ูุฐุง ุงูุณุนุฑ
    DEFAULT: 50  // ุบููุฑ ูุฐุง ุงูุณุนุฑ
  },
};
```

## ๐ฎ ุชุญุณููุงุช ูุณุชูุจููุฉ

1. **ุฅุถุงูุฉ ุญูู ุงููุฒู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช**: 
   - ุฅุถุงูุฉ `weightInKg` ุฅูู ุฌุฏูู `products` ูู Prisma schema
   - ุงุณุชุฎุฏุงู ุงููุฒู ุงููุนูู ุจุฏูุงู ูู ุงููุฒู ุงูุงูุชุฑุงุถู

2. **ุญุณุงุจ ุงูุดุญู ุงูุฏููุงูููู**:
   - ุฑุจุท ุจAPI ุดุฑูุงุช ุงูุดุญู ุงููุนููุฉ
   - ุญุณุงุจ ุงูุฃุณุนุงุฑ ุจูุงุกู ุนูู ุงูููุช ุงููุนูู

3. **ุชุฎุฒูู ุชูุงุตูู ุงูุดุญู**:
   - ุฅุถุงูุฉ ุฌุฏูู `order_shipping` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
   - ุญูุธ ุชูุงุตูู ูู ูุฑุญูุฉ ูู ูุฑุงุญู ุงูุดุญู

4. **ุฏุนู ุงูุนููุงุช ุงููุชุนุฏุฏุฉ**:
   - ุชุญููู ุงูุฃุณุนุงุฑ ูู ุงูุฏุฑูู ุงูุฅูุงุฑุงุชู ุฅูู ุนููุฉ ุงูุนููู
   - ุงุณุชุฎุฏุงู ุฃุณุนุงุฑ ุตุฑู ููุฑูุฉ

## โ ุงูุงุฎุชุจุงุฑ

ูุงุฎุชุจุงุฑ ุงููุธุงู:

1. ุฃูุดุฆ ุทูุจ ุฌุฏูุฏ ูุน ุฏููุฉ ูุฎุชููุฉ
2. ุชุญูู ูู ุฃู `shippingCost` ูุญุณูุจ ุจุดูู ุตุญูุญ
3. ุชุญูู ูู ุฃู `shippingDetails` ุชุญุชูู ุนูู ุชูุงุตูู ุงููุฑุงุญู ุงูุซูุงุซ
4. ุชุญูู ูู ุฃู `totalAmount = productsTotal + shippingCost`

## ๐ ููุงุญุธุงุช

- ุงููุฒู ุงูุงูุชุฑุงุถู ููู ููุชุฌ ูู **1 ูุฌู** ุฅุฐุง ูู ูุญุฏุฏ
- ุฌููุน ุงูุฃุณุนุงุฑ ุจุงูุฏุฑูู ุงูุฅูุงุฑุงุชู (AED)
- ูุชู ุชูุฑูุจ ุงููุจูุบ ุงูุฅุฌูุงูู ููุฃุนูู (`Math.ceil`)
